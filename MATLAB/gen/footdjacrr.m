function dJrr = footdjacrr(in1)
%FOOTDJACRR
%    DJRR = FOOTDJACRR(IN1)

%    This function was generated by the Symbolic Math Toolbox version 8.4.
%    01-Dec-2019 16:44:02

arr1 = in1(19,:);
arr2 = in1(20,:);
arr3 = in1(21,:);
darr1 = in1(40,:);
darr2 = in1(41,:);
darr3 = in1(42,:);
dqr1 = in1(28,:);
dqr2 = in1(29,:);
dqr3 = in1(30,:);
qr1 = in1(7,:);
qr2 = in1(8,:);
qr3 = in1(9,:);
dJrr = reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,darr2.*((sin(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr3).*(sin(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(sin(arr3).*(cos(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0)+darr3.*((cos(arr3).*(sin(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(sin(arr3).*(cos(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0)+dqr1.*((cos(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0-cos(qr1).*cos(qr2)+(cos(arr3).*(cos(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(cos(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3)))./2.0-(sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0+(sin(arr1).*cos(qr1).*cos(qr2))./2.0)+dqr3.*((cos(arr3).*(sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(cos(arr1).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0+(sin(arr3).*(cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr1).*cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0)-(dqr2.*sin(qr1).*(sin(qr2).*-2.0+sin(arr1).*sin(qr2)+cos(arr2).*sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr2).*cos(arr3).*sin(arr1).*sin(qr2)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)+cos(arr2).*sin(arr3).*cos(qr2).*cos(qr3)+cos(arr3).*sin(arr2).*cos(qr2).*cos(qr3)-sin(arr1).*sin(arr2).*sin(arr3).*sin(qr2)+cos(arr1).*cos(arr2).*cos(arr3).*cos(qr2).*sin(qr3)-cos(arr1).*sin(arr2).*sin(arr3).*cos(qr2).*sin(qr3)))./2.0+(darr1.*(cos(arr2+arr3)+cos(arr2)+1.0).*(cos(arr1).*cos(qr2).*sin(qr1)+sin(arr1).*cos(qr1).*cos(qr3)+sin(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0,-dqr1.*((cos(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0+cos(qr2).*sin(qr1)+(cos(arr3).*(cos(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(cos(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3)))./2.0-(sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0-(sin(arr1).*cos(qr2).*sin(qr1))./2.0)+darr2.*((sin(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr3).*(sin(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(sin(arr3).*(cos(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0)+darr3.*((cos(arr3).*(sin(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(sin(arr3).*(cos(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0)+dqr3.*((cos(arr3).*(sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(cos(arr1).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0+(sin(arr3).*(cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr1).*cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0)+(dqr2.*cos(qr1).*(sin(qr2).*-2.0+sin(arr1).*sin(qr2)+cos(arr2).*sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr2).*cos(arr3).*sin(arr1).*sin(qr2)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)+cos(arr2).*sin(arr3).*cos(qr2).*cos(qr3)+cos(arr3).*sin(arr2).*cos(qr2).*cos(qr3)-sin(arr1).*sin(arr2).*sin(arr3).*sin(qr2)+cos(arr1).*cos(arr2).*cos(arr3).*cos(qr2).*sin(qr3)-cos(arr1).*sin(arr2).*sin(arr3).*cos(qr2).*sin(qr3)))./2.0-(darr1.*(cos(arr2+arr3)+cos(arr2)+1.0).*(cos(arr1).*cos(qr1).*cos(qr2)-sin(arr1).*cos(qr3).*sin(qr1)+sin(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0,0.0,-darr3.*((sin(arr3).*cos(qr1).*(cos(arr2).*sin(arr1).*sin(qr2)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*cos(qr1).*(-cos(arr2).*cos(qr2).*cos(qr3)+sin(arr1).*sin(arr2).*sin(qr2)+cos(arr1).*sin(arr2).*cos(qr2).*sin(qr3)))./2.0)-darr2.*((sin(arr2).*cos(qr1).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)))./2.0+(sin(arr3).*cos(qr1).*(cos(arr2).*sin(arr1).*sin(qr2)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*cos(qr1).*(-cos(arr2).*cos(qr2).*cos(qr3)+sin(arr1).*sin(arr2).*sin(qr2)+cos(arr1).*sin(arr2).*cos(qr2).*sin(qr3)))./2.0-(cos(arr2).*cos(qr1).*cos(qr2).*cos(qr3))./2.0)-(dqr1.*sin(qr1).*(sin(qr2).*-2.0+sin(arr1).*sin(qr2)+cos(arr2).*sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr2).*cos(arr3).*sin(arr1).*sin(qr2)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)+cos(arr2).*sin(arr3).*cos(qr2).*cos(qr3)+cos(arr3).*sin(arr2).*cos(qr2).*cos(qr3)-sin(arr1).*sin(arr2).*sin(arr3).*sin(qr2)+cos(arr1).*cos(arr2).*cos(arr3).*cos(qr2).*sin(qr3)-cos(arr1).*sin(arr2).*sin(arr3).*cos(qr2).*sin(qr3)))./2.0-(dqr2.*cos(qr1).*(cos(qr2).*2.0-sin(arr1).*cos(qr2)-cos(arr2).*sin(arr1).*cos(qr2)+cos(arr1).*sin(qr2).*sin(qr3)+sin(arr2).*cos(qr3).*sin(qr2)-cos(arr2).*cos(arr3).*sin(arr1).*cos(qr2)+sin(arr1).*sin(arr2).*sin(arr3).*cos(qr2)+cos(arr1).*cos(arr2).*sin(qr2).*sin(qr3)+cos(arr2).*sin(arr3).*cos(qr3).*sin(qr2)+cos(arr3).*sin(arr2).*cos(qr3).*sin(qr2)+cos(arr1).*cos(arr2).*cos(arr3).*sin(qr2).*sin(qr3)-cos(arr1).*sin(arr2).*sin(arr3).*sin(qr2).*sin(qr3)))./2.0-(dqr3.*cos(qr1).*cos(qr2).*(sin(arr2).*sin(qr3)-cos(arr1).*cos(qr3)-cos(arr1).*cos(arr2).*cos(qr3)+cos(arr2).*sin(arr3).*sin(qr3)+cos(arr3).*sin(arr2).*sin(qr3)-cos(arr1).*cos(arr2).*cos(arr3).*cos(qr3)+cos(arr1).*sin(arr2).*sin(arr3).*cos(qr3)))./2.0+(darr1.*cos(qr1).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,-darr3.*((sin(arr3).*sin(qr1).*(cos(arr2).*sin(arr1).*sin(qr2)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*sin(qr1).*(-cos(arr2).*cos(qr2).*cos(qr3)+sin(arr1).*sin(arr2).*sin(qr2)+cos(arr1).*sin(arr2).*cos(qr2).*sin(qr3)))./2.0)-darr2.*((sin(arr2).*sin(qr1).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)))./2.0+(sin(arr3).*sin(qr1).*(cos(arr2).*sin(arr1).*sin(qr2)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*sin(qr1).*(-cos(arr2).*cos(qr2).*cos(qr3)+sin(arr1).*sin(arr2).*sin(qr2)+cos(arr1).*sin(arr2).*cos(qr2).*sin(qr3)))./2.0-(cos(arr2).*cos(qr2).*cos(qr3).*sin(qr1))./2.0)+(dqr1.*cos(qr1).*(sin(qr2).*-2.0+sin(arr1).*sin(qr2)+cos(arr2).*sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr2).*cos(arr3).*sin(arr1).*sin(qr2)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)+cos(arr2).*sin(arr3).*cos(qr2).*cos(qr3)+cos(arr3).*sin(arr2).*cos(qr2).*cos(qr3)-sin(arr1).*sin(arr2).*sin(arr3).*sin(qr2)+cos(arr1).*cos(arr2).*cos(arr3).*cos(qr2).*sin(qr3)-cos(arr1).*sin(arr2).*sin(arr3).*cos(qr2).*sin(qr3)))./2.0-(dqr2.*sin(qr1).*(cos(qr2).*2.0-sin(arr1).*cos(qr2)-cos(arr2).*sin(arr1).*cos(qr2)+cos(arr1).*sin(qr2).*sin(qr3)+sin(arr2).*cos(qr3).*sin(qr2)-cos(arr2).*cos(arr3).*sin(arr1).*cos(qr2)+sin(arr1).*sin(arr2).*sin(arr3).*cos(qr2)+cos(arr1).*cos(arr2).*sin(qr2).*sin(qr3)+cos(arr2).*sin(arr3).*cos(qr3).*sin(qr2)+cos(arr3).*sin(arr2).*cos(qr3).*sin(qr2)+cos(arr1).*cos(arr2).*cos(arr3).*sin(qr2).*sin(qr3)-cos(arr1).*sin(arr2).*sin(arr3).*sin(qr2).*sin(qr3)))./2.0-(dqr3.*cos(qr2).*sin(qr1).*(sin(arr2).*sin(qr3)-cos(arr1).*cos(qr3)-cos(arr1).*cos(arr2).*cos(qr3)+cos(arr2).*sin(arr3).*sin(qr3)+cos(arr3).*sin(arr2).*sin(qr3)-cos(arr1).*cos(arr2).*cos(arr3).*cos(qr3)+cos(arr1).*sin(arr2).*sin(arr3).*cos(qr3)))./2.0+(darr1.*sin(qr1).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,-darr3.*((cos(arr3).*(sin(arr1).*sin(arr2).*cos(qr2)+cos(arr2).*cos(qr3).*sin(qr2)-cos(arr1).*sin(arr2).*sin(qr2).*sin(qr3)))./2.0-(sin(arr3).*(-cos(arr2).*sin(arr1).*cos(qr2)+sin(arr2).*cos(qr3).*sin(qr2)+cos(arr1).*cos(arr2).*sin(qr2).*sin(qr3)))./2.0)-darr2.*((cos(arr3).*(sin(arr1).*sin(arr2).*cos(qr2)+cos(arr2).*cos(qr3).*sin(qr2)-cos(arr1).*sin(arr2).*sin(qr2).*sin(qr3)))./2.0-(sin(arr3).*(-cos(arr2).*sin(arr1).*cos(qr2)+sin(arr2).*cos(qr3).*sin(qr2)+cos(arr1).*cos(arr2).*sin(qr2).*sin(qr3)))./2.0+(sin(arr2).*(sin(arr1).*cos(qr2)-cos(arr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr2).*cos(qr3).*sin(qr2))./2.0)-dqr2.*(-sin(qr2)-(sin(arr3).*(-cos(arr2).*cos(qr2).*cos(qr3)+sin(arr1).*sin(arr2).*sin(qr2)+cos(arr1).*sin(arr2).*cos(qr2).*sin(qr3)))./2.0+(sin(arr1).*sin(qr2))./2.0+(cos(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*(cos(arr2).*sin(arr1).*sin(qr2)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)))./2.0+(cos(arr1).*cos(qr2).*sin(qr3))./2.0+(sin(arr2).*cos(qr2).*cos(qr3))./2.0)+(dqr3.*sin(qr2).*(sin(arr2).*sin(qr3)-cos(arr1).*cos(qr3)-cos(arr1).*cos(arr2).*cos(qr3)+cos(arr2).*sin(arr3).*sin(qr3)+cos(arr3).*sin(arr2).*sin(qr3)-cos(arr1).*cos(arr2).*cos(arr3).*cos(qr3)+cos(arr1).*sin(arr2).*sin(arr3).*cos(qr3)))./2.0+(darr1.*(cos(arr1).*cos(qr2)+sin(arr1).*sin(qr2).*sin(qr3)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,darr3.*((cos(arr3).*(cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0)+darr2.*((cos(arr3).*(cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3)))./2.0-(sin(arr3).*(sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(cos(arr1).*sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0)+dqr1.*((cos(arr3).*(sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(cos(arr1).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0+(sin(arr3).*(cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr1).*cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0)-dqr3.*((cos(arr3).*(sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))-cos(arr1).*cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))))./2.0-(cos(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(sin(arr3).*(cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))+cos(arr1).*sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))))./2.0+(sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0-(cos(arr1).*cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3)))./2.0)-(dqr2.*cos(qr1).*cos(qr2).*(sin(arr2).*sin(qr3)-cos(arr1).*cos(qr3)-cos(arr1).*cos(arr2).*cos(qr3)+cos(arr2).*sin(arr3).*sin(qr3)+cos(arr3).*sin(arr2).*sin(qr3)-cos(arr1).*cos(arr2).*cos(arr3).*cos(qr3)+cos(arr1).*sin(arr2).*sin(arr3).*cos(qr3)))./2.0-(darr1.*sin(arr1).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,-darr3.*((cos(arr3).*(cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0)-darr2.*((cos(arr3).*(cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3)))./2.0-(sin(arr3).*(sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(cos(arr1).*sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0)+dqr1.*((cos(arr3).*(sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(cos(arr1).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0+(sin(arr3).*(cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr1).*cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0)+dqr3.*((cos(arr3).*(sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))-cos(arr1).*cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))))./2.0-(cos(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3)))./2.0+(sin(arr3).*(cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))+cos(arr1).*sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))))./2.0+(sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0-(cos(arr1).*cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3)))./2.0)-(dqr2.*cos(qr2).*sin(qr1).*(sin(arr2).*sin(qr3)-cos(arr1).*cos(qr3)-cos(arr1).*cos(arr2).*cos(qr3)+cos(arr2).*sin(arr3).*sin(qr3)+cos(arr3).*sin(arr2).*sin(qr3)-cos(arr1).*cos(arr2).*cos(arr3).*cos(qr3)+cos(arr1).*sin(arr2).*sin(arr3).*cos(qr3)))./2.0+(darr1.*sin(arr1).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,darr2.*cos(qr2).*(cos(arr2).*sin(qr3)+cos(arr1).*sin(arr2).*cos(qr3)+cos(arr2).*cos(arr3).*sin(qr3)-sin(arr2).*sin(arr3).*sin(qr3)+cos(arr1).*cos(arr2).*sin(arr3).*cos(qr3)+cos(arr1).*cos(arr3).*sin(arr2).*cos(qr3)).*(-1.0./2.0)-(dqr3.*cos(qr2).*(cos(arr1).*sin(qr3)+sin(arr2).*cos(qr3)+cos(arr1).*cos(arr2).*sin(qr3)+cos(arr2).*sin(arr3).*cos(qr3)+cos(arr3).*sin(arr2).*cos(qr3)+cos(arr1).*cos(arr2).*cos(arr3).*sin(qr3)-cos(arr1).*sin(arr2).*sin(arr3).*sin(qr3)))./2.0+(dqr2.*sin(qr2).*(sin(arr2).*sin(qr3)-cos(arr1).*cos(qr3)-cos(arr1).*cos(arr2).*cos(qr3)+cos(arr2).*sin(arr3).*sin(qr3)+cos(arr3).*sin(arr2).*sin(qr3)-cos(arr1).*cos(arr2).*cos(arr3).*cos(qr3)+cos(arr1).*sin(arr2).*sin(arr3).*cos(qr3)))./2.0-(darr3.*cos(qr2).*(cos(arr2).*cos(arr3).*sin(qr3)-sin(arr2).*sin(arr3).*sin(qr3)+cos(arr1).*cos(arr2).*sin(arr3).*cos(qr3)+cos(arr1).*cos(arr3).*sin(arr2).*cos(qr3)))./2.0-(darr1.*sin(arr1).*cos(qr2).*cos(qr3).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,(darr3.*sin(arr2+arr3).*(cos(arr1).*cos(qr1).*cos(qr2)-sin(arr1).*cos(qr3).*sin(qr1)+sin(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(darr1.*(cos(arr2+arr3)+cos(arr2)+1.0).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(dqr1.*(cos(arr2+arr3)+cos(arr2)+1.0).*(cos(arr1).*cos(qr2).*sin(qr1)+sin(arr1).*cos(qr1).*cos(qr3)+sin(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0+(darr2.*(sin(arr2+arr3)+sin(arr2)).*(cos(arr1).*cos(qr1).*cos(qr2)-sin(arr1).*cos(qr3).*sin(qr1)+sin(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(dqr2.*cos(qr1).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0-(dqr3.*sin(arr1).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,(darr3.*sin(arr2+arr3).*(cos(arr1).*cos(qr2).*sin(qr1)+sin(arr1).*cos(qr1).*cos(qr3)+sin(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0-(darr1.*(cos(arr2+arr3)+cos(arr2)+1.0).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0-(dqr1.*(cos(arr2+arr3)+cos(arr2)+1.0).*(cos(arr1).*cos(qr1).*cos(qr2)-sin(arr1).*cos(qr3).*sin(qr1)+sin(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(darr2.*(sin(arr2+arr3)+sin(arr2)).*(cos(arr1).*cos(qr2).*sin(qr1)+sin(arr1).*cos(qr1).*cos(qr3)+sin(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0+(dqr2.*sin(qr1).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0+(dqr3.*sin(arr1).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,darr3.*sin(arr2+arr3).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)).*(-1.0./2.0)-(darr1.*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0+(dqr2.*(cos(arr1).*cos(qr2)+sin(arr1).*sin(qr2).*sin(qr3)).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0-(darr2.*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)).*(sin(arr2+arr3)+sin(arr2)))./2.0-(dqr3.*sin(arr1).*cos(qr2).*cos(qr3).*(cos(arr2+arr3)+cos(arr2)+1.0))./2.0,darr2.*((cos(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr3).*(cos(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0)+dqr3.*((cos(arr3).*(cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3)))./2.0-(sin(arr3).*(sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(cos(arr1).*sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0)+dqr1.*((sin(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr3).*(sin(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(sin(arr3).*(cos(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0)+darr3.*((cos(arr3).*(cos(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0)-dqr2.*((sin(arr2).*cos(qr1).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)))./2.0+(sin(arr3).*cos(qr1).*(cos(arr2).*sin(arr1).*sin(qr2)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*cos(qr1).*(-cos(arr2).*cos(qr2).*cos(qr3)+sin(arr1).*sin(arr2).*sin(qr2)+cos(arr1).*sin(arr2).*cos(qr2).*sin(qr3)))./2.0-(cos(arr2).*cos(qr1).*cos(qr2).*cos(qr3))./2.0)+(darr1.*(sin(arr2+arr3)+sin(arr2)).*(cos(arr1).*cos(qr1).*cos(qr2)-sin(arr1).*cos(qr3).*sin(qr1)+sin(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0,dqr1.*((sin(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr3).*(sin(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(sin(arr3).*(cos(arr2).*(sin(arr1).*cos(qr1).*cos(qr2)+cos(arr1).*cos(qr3).*sin(qr1)-cos(arr1).*cos(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0+(cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2)))./2.0)-dqr3.*((cos(arr3).*(cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3)))./2.0-(sin(arr3).*(sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(cos(arr1).*sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0)-darr2.*((cos(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr3).*(cos(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2)))./2.0)-darr3.*((cos(arr3).*(cos(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(arr1).*cos(qr1).*cos(qr3)-sin(arr1).*cos(qr2).*sin(qr1)+cos(arr1).*sin(qr1).*sin(qr2).*sin(qr3))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0)-dqr2.*((sin(arr2).*sin(qr1).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)))./2.0+(sin(arr3).*sin(qr1).*(cos(arr2).*sin(arr1).*sin(qr2)+sin(arr2).*cos(qr2).*cos(qr3)+cos(arr1).*cos(arr2).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*sin(qr1).*(-cos(arr2).*cos(qr2).*cos(qr3)+sin(arr1).*sin(arr2).*sin(qr2)+cos(arr1).*sin(arr2).*cos(qr2).*sin(qr3)))./2.0-(cos(arr2).*cos(qr2).*cos(qr3).*sin(qr1))./2.0)+(darr1.*(sin(arr2+arr3)+sin(arr2)).*(cos(arr1).*cos(qr2).*sin(qr1)+sin(arr1).*cos(qr1).*cos(qr3)+sin(arr1).*sin(qr1).*sin(qr2).*sin(qr3)))./2.0,-darr2.*((cos(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*(cos(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3))+sin(arr2).*cos(qr2).*cos(qr3)))./2.0-(sin(arr3).*(sin(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3))-cos(arr2).*cos(qr2).*cos(qr3)))./2.0+(sin(arr2).*cos(qr2).*cos(qr3))./2.0)-darr1.*((sin(arr2).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)))./2.0+(cos(arr2).*sin(arr3).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*sin(arr2).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)))./2.0)-dqr2.*((sin(arr2).*(sin(arr1).*cos(qr2)-cos(arr1).*sin(qr2).*sin(qr3)))./2.0+(cos(arr3).*(sin(arr2).*(sin(arr1).*cos(qr2)-cos(arr1).*sin(qr2).*sin(qr3))+cos(arr2).*cos(qr3).*sin(qr2)))./2.0+(sin(arr3).*(cos(arr2).*(sin(arr1).*cos(qr2)-cos(arr1).*sin(qr2).*sin(qr3))-sin(arr2).*cos(qr3).*sin(qr2)))./2.0+(cos(arr2).*cos(qr3).*sin(qr2))./2.0)-dqr3.*((cos(arr3).*(cos(arr2).*cos(qr2).*sin(qr3)+cos(arr1).*sin(arr2).*cos(qr2).*cos(qr3)))./2.0-(sin(arr3).*(sin(arr2).*cos(qr2).*sin(qr3)-cos(arr1).*cos(arr2).*cos(qr2).*cos(qr3)))./2.0+(cos(arr2).*cos(qr2).*sin(qr3))./2.0+(cos(arr1).*sin(arr2).*cos(qr2).*cos(qr3))./2.0)-darr3.*((cos(arr3).*(cos(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3))+sin(arr2).*cos(qr2).*cos(qr3)))./2.0-(sin(arr3).*(sin(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3))-cos(arr2).*cos(qr2).*cos(qr3)))./2.0),dqr3.*((cos(arr3).*(cos(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0)-darr2.*((cos(arr3).*(sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))-cos(arr2).*(cos(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+sin(arr1).*cos(qr1).*cos(qr2))))./2.0+(sin(arr3).*(sin(arr2).*(cos(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+sin(arr1).*cos(qr1).*cos(qr2))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0)-darr3.*((cos(arr3).*(sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))-cos(arr2).*(cos(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+sin(arr1).*cos(qr1).*cos(qr2))))./2.0+(sin(arr3).*(sin(arr2).*(cos(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+sin(arr1).*cos(qr1).*cos(qr2))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0)+dqr1.*((cos(arr3).*(sin(arr2).*(cos(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-sin(arr1).*cos(qr2).*sin(qr1))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0+(sin(arr3).*(cos(arr2).*(cos(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-sin(arr1).*cos(qr2).*sin(qr1))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0)-darr1.*((cos(arr2).*sin(arr3).*(sin(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*cos(qr1).*cos(qr2)))./2.0+(cos(arr3).*sin(arr2).*(sin(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*cos(qr1).*cos(qr2)))./2.0)-dqr2.*((cos(arr3).*(sin(arr2).*(sin(arr1).*cos(qr1).*sin(qr2)+cos(arr1).*cos(qr1).*cos(qr2).*sin(qr3))-cos(arr2).*cos(qr1).*cos(qr2).*cos(qr3)))./2.0+(sin(arr3).*(cos(arr2).*(sin(arr1).*cos(qr1).*sin(qr2)+cos(arr1).*cos(qr1).*cos(qr2).*sin(qr3))+sin(arr2).*cos(qr1).*cos(qr2).*cos(qr3)))./2.0),-dqr2.*((cos(arr3).*(sin(arr2).*(sin(arr1).*sin(qr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr1).*sin(qr3))-cos(arr2).*cos(qr2).*cos(qr3).*sin(qr1)))./2.0+(sin(arr3).*(cos(arr2).*(sin(arr1).*sin(qr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr1).*sin(qr3))+sin(arr2).*cos(qr2).*cos(qr3).*sin(qr1)))./2.0)-dqr3.*((cos(arr3).*(cos(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-cos(arr1).*sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0)+dqr1.*((cos(arr3).*(sin(arr2).*(cos(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+sin(arr1).*cos(qr1).*cos(qr2))+cos(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(sin(qr1).*sin(qr3)+cos(qr1).*cos(qr3).*sin(qr2))-cos(arr2).*(cos(arr1).*(cos(qr3).*sin(qr1)-cos(qr1).*sin(qr2).*sin(qr3))+sin(arr1).*cos(qr1).*cos(qr2))))./2.0)-darr2.*((cos(arr3).*(cos(arr2).*(cos(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-sin(arr1).*cos(qr2).*sin(qr1))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-sin(arr1).*cos(qr2).*sin(qr1))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0)-darr3.*((cos(arr3).*(cos(arr2).*(cos(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-sin(arr1).*cos(qr2).*sin(qr1))-sin(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0-(sin(arr3).*(sin(arr2).*(cos(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))-sin(arr1).*cos(qr2).*sin(qr1))+cos(arr2).*(cos(qr1).*sin(qr3)-cos(qr3).*sin(qr1).*sin(qr2))))./2.0)+darr1.*((cos(arr2).*sin(arr3).*(sin(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(qr2).*sin(qr1)))./2.0+(cos(arr3).*sin(arr2).*(sin(arr1).*(cos(qr1).*cos(qr3)+sin(qr1).*sin(qr2).*sin(qr3))+cos(arr1).*cos(qr2).*sin(qr1)))./2.0),-dqr2.*((cos(arr3).*(sin(arr2).*(sin(arr1).*cos(qr2)-cos(arr1).*sin(qr2).*sin(qr3))+cos(arr2).*cos(qr3).*sin(qr2)))./2.0+(sin(arr3).*(cos(arr2).*(sin(arr1).*cos(qr2)-cos(arr1).*sin(qr2).*sin(qr3))-sin(arr2).*cos(qr3).*sin(qr2)))./2.0)-dqr3.*((cos(arr3).*(cos(arr2).*cos(qr2).*sin(qr3)+cos(arr1).*sin(arr2).*cos(qr2).*cos(qr3)))./2.0-(sin(arr3).*(sin(arr2).*cos(qr2).*sin(qr3)-cos(arr1).*cos(arr2).*cos(qr2).*cos(qr3)))./2.0)-darr1.*((cos(arr2).*sin(arr3).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)))./2.0+(cos(arr3).*sin(arr2).*(cos(arr1).*sin(qr2)-sin(arr1).*cos(qr2).*sin(qr3)))./2.0)-darr2.*((cos(arr3).*(cos(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3))+sin(arr2).*cos(qr2).*cos(qr3)))./2.0-(sin(arr3).*(sin(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3))-cos(arr2).*cos(qr2).*cos(qr3)))./2.0)-darr3.*((cos(arr3).*(cos(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3))+sin(arr2).*cos(qr2).*cos(qr3)))./2.0-(sin(arr3).*(sin(arr2).*(sin(arr1).*sin(qr2)+cos(arr1).*cos(qr2).*sin(qr3))-cos(arr2).*cos(qr2).*cos(qr3)))./2.0)],[3,21]);
